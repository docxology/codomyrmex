# PAI Scripts — scripts/pai

**Version**: v0.1.0 | **Status**: Active | **Last Updated**: February 2026

## Overview

Orchestration scripts for the Codomyrmex PAI dashboard (port 8787). Single entry point to set up, restart, and launch the dashboard with browser pop-up.

## Quick Start

```bash
# Full setup + start + open browser
uv run python scripts/pai/dashboard.py

# Kill existing server, regenerate, restart, open browser
uv run python scripts/pai/dashboard.py --restart

# Generate static files only (no server)
uv run python scripts/pai/dashboard.py --setup-only

# Start server without opening browser
uv run python scripts/pai/dashboard.py --no-open

# Skip file generation, just restart the server
uv run python scripts/pai/dashboard.py --no-setup --restart
```

## Scripts

| File | Description |
|------|-------------|
| `dashboard.py` | PAI dashboard orchestrator — setup, restart, and launch |

## What `dashboard.py` Does

Three sequential phases:

1. **RESTART** (optional `--restart`): Finds and kills any process on port 8787 via `lsof` + SIGTERM/SIGKILL.
2. **SETUP** (skippable with `--no-setup`): Runs `WebsiteGenerator` to render all Jinja2 templates to `output/website/`, writes root `index.html` redirect.
3. **RUN**: Initialises `DataProvider`, binds `WebsiteServer` on the requested port, opens browser after 1.2s delay.

## Architecture

```
┌─────────────────────────────────────────────────────────────┐
│                       dashboard.py                          │
│  Orchestrates startup, kills stale processes, opens browser │
└───────────────────────┬─────────────────────────────────────┘
                        │ spawns
          ┌─────────────┴──────────────┐
          │                            │
          ▼                            ▼
┌─────────────────┐          ┌─────────────────────────┐
│  PMServer.ts    │          │  WebsiteServer (Python)  │
│  :8888 (bun)   │          │  :8787                   │
│                 │          │                           │
│  Project Mgr    │          │  Admin dashboard UI       │
│  Task CRUD      │          │  Reads same data files    │
│  Dispatch jobs  │          │  Jinja2 → static HTML     │
│  Calendar auth  │          │                           │
└─────────────────┘          └─────────────────────────┘
        │
        └── ~/.codomyrmex/gcal_token.json
            (consumed by Codomyrmex MCP Tools)
```

Both servers read from the same underlying data files — no sync layer is needed between them.

## Security

> ⚠️ **Network Exposure Warning**

By default, both servers bind to `0.0.0.0`, which means they are reachable on **all network interfaces**, including any LAN or cloud network your machine is connected to.

**Recommendations:**
- On shared or cloud environments, restrict to loopback: `--host 127.0.0.1` (flag support depends on your dashboard.py version).
- Neither server implements an authentication layer — anyone who can reach port 8787 or 8888 can read and mutate your PAI data.
- Do not run with `0.0.0.0` binding on machines accessible from the public internet.

## Troubleshooting

| Symptom | Resolution |
|---------|-----------|
| **Port already in use** | Run `uv run python scripts/pai/dashboard.py --restart`, or manually: `lsof -ti :8787 \| xargs kill -9` (replace port as needed) |
| **`bun` not found** | Install Bun: `curl -fsSL https://bun.sh/install \| bash`, then restart your shell. Or skip PMServer: `uv run python scripts/pai/dashboard.py --no-pai-pm` if that flag is available |
| **PMServer crashes silently** | Run PMServer manually to see the error: `bun ~/.claude/skills/PAI/Tools/PMServer.ts` |
| **Dashboard shows no data** | Re-run setup phase: `uv run python scripts/pai/dashboard.py --setup-only`, then restart |
| **`uv` not found** | Install uv: `curl -LsSf https://astral.sh/uv/install.sh \| sh` |

## Related

- Dashboard URL: `http://localhost:8787`
- PAI Project Manager: `http://localhost:8888` (`bun ~/.claude/skills/PAI/Tools/PMServer.ts`)
- Google Calendar Auth Token: Generated by PAI at `~/.codomyrmex/gcal_token.json` (consumed by Codomyrmex MCP Tools)
- Server implementation: `src/codomyrmex/website/server.py`
- Templates: `src/codomyrmex/website/templates/`
