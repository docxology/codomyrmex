# Configuration Inheritance Example
# Demonstrates how configurations can inherit and override settings
# This example shows a hierarchical configuration structure

# Base configuration - shared settings
base:
  app:
    name: "Codomyrmex"
    version: "1.0.0"
    description: "Modular coding workspace"

  logging:
    format: "%(asctime)s - %(levelname)s - %(message)s"
    max_file_size: 10485760
    backup_count: 5

  performance:
    enable_monitoring: true
    memory_limit: 512MB

  security:
    validate_inputs: true
    audit_trail: true

# Development environment - inherits from base
development:
  extends: base

  logging:
    level: DEBUG
    file: logs/dev.log

  database:
    type: sqlite
    database: dev.db

  api:
    debug: true
    port: 8000
    timeout: 60

  features:
    hot_reload: true
    debug_toolbar: true
    experimental: true

# Staging environment - inherits from base
staging:
  extends: base

  logging:
    level: INFO
    file: logs/staging.log

  database:
    type: postgresql
    host: "${STAGING_DB_HOST}"
    port: 5432
    name: "staging_codomyrmex"

  api:
    debug: false
    port: 8443
    timeout: 30

  features:
    experimental: false
    monitoring: true

# Production environment - inherits from base
production:
  extends: base

  logging:
    level: WARNING
    file: logs/prod.log

  database:
    type: postgresql
    host: "${PROD_DB_HOST}"
    port: 5432
    name: "prod_codomyrmex"
    ssl_enabled: true

  api:
    debug: false
    port: 443
    timeout: 15

  features:
    experimental: false
    monitoring: true
    auto_scaling: true

# Service-specific overrides
services:
  api_service:
    extends: production

    api:
      rate_limit: 1000
      cors_enabled: true

    features:
      api_gateway: true

  worker_service:
    extends: production

    performance:
      memory_limit: 2GB
      cpu_limit: 80

    features:
      background_jobs: true
      queue_processing: true

  analytics_service:
    extends: production

    database:
      additional_databases:
        - name: "analytics_db"
          type: "clickhouse"

    features:
      real_time_analytics: true
      data_warehousing: true

# Feature flag inheritance
feature_flags:
  base_flags:
    core_features: true
    logging: true
    monitoring: false

  dev_flags:
    extends: base_flags
    monitoring: true
    experimental: true
    debug_features: true

  prod_flags:
    extends: base_flags
    monitoring: true
    experimental: false
    performance_optimization: true

# Configuration merging examples
merge_examples:
  # Dictionary merge (shallow)
  shallow_merge:
    base:
      a: 1
      b: 2
    override:
      b: 20
      c: 30
    result:
      a: 1
      b: 20
      c: 30

  # Deep merge example
  deep_merge:
    base:
      database:
        host: localhost
        credentials:
          username: user
          password: pass
      api:
        endpoints:
          - users
          - posts
    override:
      database:
        credentials:
          password: new_pass
      api:
        endpoints:
          - comments
    result:
      database:
        host: localhost
        credentials:
          username: user
          password: new_pass
      api:
        endpoints:
          - users
          - posts
          - comments

# Conditional configuration
conditional_config:
  development:
    when: "${ENV} == 'development'"
    config:
      debug: true
      log_level: DEBUG

  production:
    when: "${ENV} == 'production'"
    config:
      debug: false
      log_level: WARNING

  staging:
    when: "${ENV} == 'staging'"
    config:
      debug: false
      log_level: INFO
